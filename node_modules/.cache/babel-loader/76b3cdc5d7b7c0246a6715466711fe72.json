{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nexports.__esModule = true;\nexports.executeQuery = void 0;\n\nvar debug_1 = require(\"debug\");\n\nvar glossary_1 = require(\"../glossary\");\n\nvar compileQuery_1 = require(\"./compileQuery\");\n\nvar iteratorUtils = __importStar(require(\"../utils/iteratorUtils\"));\n\nvar paginateResults_1 = require(\"./paginateResults\");\n\nvar sortResults_1 = require(\"./sortResults\");\n\nvar log = debug_1.debug('executeQuery');\n\nfunction queryByPrimaryKey(records, query) {\n  log('querying by primary key');\n  var matchPrimaryKey = compileQuery_1.compileQuery(query);\n  return iteratorUtils.filter(function (id, value) {\n    var _a;\n\n    return matchPrimaryKey((_a = {}, _a[value[glossary_1.InternalEntityProperty.primaryKey]] = id, _a));\n  }, records);\n}\n/**\n * Execute a given query against a model in the database.\n * Returns the list of records that satisfy the query.\n */\n\n\nfunction executeQuery(modelName, primaryKey, query, db) {\n  var _a;\n\n  log(JSON.stringify(query) + \" on \\\"\" + modelName + \"\\\"\");\n  var records = db.getModel(modelName); // Reduce the query scope if there's a query by primary key of the model.\n\n  var _b = query.where || {},\n      _c = primaryKey,\n      primaryKeyComparator = _b[_c],\n      restQueries = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n  log('primary key query', primaryKeyComparator);\n  var scopedRecords = primaryKeyComparator ? queryByPrimaryKey(db.getModel(modelName), {\n    where: (_a = {}, _a[primaryKey] = primaryKeyComparator, _a)\n  }) : records;\n  var result = iteratorUtils.filter(function (_, record) {\n    var executeQuery = compileQuery_1.compileQuery({\n      where: restQueries\n    });\n    return executeQuery(record);\n  }, scopedRecords);\n  var resultJson = Array.from(result.values());\n  log(\"resolved query \\\"\" + JSON.stringify(query) + \"\\\" on \\\"\" + modelName + \"\\\" to\", resultJson);\n\n  if (query.orderBy) {\n    sortResults_1.sortResults(query.orderBy, resultJson);\n  }\n\n  var paginatedResults = paginateResults_1.paginateResults(query, resultJson);\n  log('paginated query results', paginatedResults);\n  return paginatedResults;\n}\n\nexports.executeQuery = executeQuery;","map":{"version":3,"sources":["/Users/selamhabteab/Desktop/Projects/redux/redux-essentials-example-app/node_modules/@mswjs/data/lib/query/executeQuery.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","__rest","s","e","t","p","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","exports","executeQuery","debug_1","require","glossary_1","compileQuery_1","iteratorUtils","paginateResults_1","sortResults_1","log","debug","queryByPrimaryKey","records","query","matchPrimaryKey","compileQuery","filter","id","_a","InternalEntityProperty","primaryKey","modelName","db","JSON","stringify","getModel","_b","where","_c","primaryKeyComparator","restQueries","scopedRecords","_","record","resultJson","Array","from","values","orderBy","sortResults","paginatedResults","paginateResults"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nexports.__esModule = true;\nexports.executeQuery = void 0;\nvar debug_1 = require(\"debug\");\nvar glossary_1 = require(\"../glossary\");\nvar compileQuery_1 = require(\"./compileQuery\");\nvar iteratorUtils = __importStar(require(\"../utils/iteratorUtils\"));\nvar paginateResults_1 = require(\"./paginateResults\");\nvar sortResults_1 = require(\"./sortResults\");\nvar log = debug_1.debug('executeQuery');\nfunction queryByPrimaryKey(records, query) {\n    log('querying by primary key');\n    var matchPrimaryKey = compileQuery_1.compileQuery(query);\n    return iteratorUtils.filter(function (id, value) {\n        var _a;\n        return matchPrimaryKey((_a = {},\n            _a[value[glossary_1.InternalEntityProperty.primaryKey]] = id,\n            _a));\n    }, records);\n}\n/**\n * Execute a given query against a model in the database.\n * Returns the list of records that satisfy the query.\n */\nfunction executeQuery(modelName, primaryKey, query, db) {\n    var _a;\n    log(JSON.stringify(query) + \" on \\\"\" + modelName + \"\\\"\");\n    var records = db.getModel(modelName);\n    // Reduce the query scope if there's a query by primary key of the model.\n    var _b = query.where || {}, _c = primaryKey, primaryKeyComparator = _b[_c], restQueries = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n    log('primary key query', primaryKeyComparator);\n    var scopedRecords = primaryKeyComparator\n        ? queryByPrimaryKey(db.getModel(modelName), {\n            where: (_a = {}, _a[primaryKey] = primaryKeyComparator, _a)\n        })\n        : records;\n    var result = iteratorUtils.filter(function (_, record) {\n        var executeQuery = compileQuery_1.compileQuery({ where: restQueries });\n        return executeQuery(record);\n    }, scopedRecords);\n    var resultJson = Array.from(result.values());\n    log(\"resolved query \\\"\" + JSON.stringify(query) + \"\\\" on \\\"\" + modelName + \"\\\" to\", resultJson);\n    if (query.orderBy) {\n        sortResults_1.sortResults(query.orderBy, resultJson);\n    }\n    var paginatedResults = paginateResults_1.paginateResults(query, resultJson);\n    log('paginated query results', paginatedResults);\n    return paginatedResults;\n}\nexports.executeQuery = executeQuery;\n"]},"metadata":{},"sourceType":"script"}